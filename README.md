# QQ群成员管理系统
> AI完成，使用请开启NapCat的http服务

这是一个基于PyQt5开发的QQ群成员管理可视化界面工具，通过连接API接口获取QQ群信息，提供群成员列表的查看、排序、导出等功能。

## 功能特点

- **群列表管理**：自动获取并展示所有群聊，支持搜索和筛选功能
- **群信息查询与显示**：查询并展示群名称、群号、群备注、成员数量等基本信息
- **群成员列表管理**：以表格形式展示群成员详细信息，包括QQ号、昵称、群名片等
- **角色区分**：使用不同颜色标记群主、管理员和普通成员
- **用户详情查看**：双击成员可查看详细资料，包括性别、年龄、地区、加群时间等
- **群成员禁言**：支持对普通成员设置禁言，可选择预设时长或自定义时长
- **数据导出**：支持将群成员信息导出为CSV或JSON格式，可自定义导出字段
- **分页浏览**：大型群的成员列表支持分页浏览
- **多主题切换**：提供默认、蓝色、深色和浅绿色四种主题
- **折叠式界面**：群信息和群成员列表区域可折叠，优化界面空间利用
- **设置持久化**：保存用户的URL、Token和界面偏好设置

## 安装依赖

本项目依赖以下Python库：

```bash
pip install PyQt5 requests
```

## 使用方法

1. 确保已安装所有依赖项
2. 运行主程序：

```bash
python vimeGroup.py
```

3. 在程序界面中设置服务器URL和Token
4. 输入要查询的群号
5. 点击"查询群信息"按钮获取数据

## API接口要求

程序通过以下API接口获取数据：

- `/get_group_list` - 获取群列表
- `/get_group_info` - 获取群基本信息
- `/get_group_member_list` - 获取群成员列表
- `/get_group_member_info` - 获取群成员详细信息
- `/set_group_ban` - 设置群成员禁言

请确保您配置的API服务器支持这些接口，并接受以下格式的请求：

```json
{
  "group_id": "群号",
  "no_cache": false
}
```

禁言接口接受以下格式的请求：
```json
{
  "group_id": "群号",
  "user_id": "群成员id",
  "duration": 禁言的秒数
}
```

## 禁言功能

- 双击群成员列表中的成员查看详情，点击"设置禁言"按钮
- 支持预设禁言时长：5分钟、30分钟、1小时、12小时、1天、7天、30天
- 支持自定义禁言时长（分钟、小时、天）
- 禁言功能仅对普通成员生效，且需要当前账号拥有管理员或群主权限
- 禁言操作结果会通过提示框反馈

## 界面特性

- **现代化布局**：左侧群列表面板，右侧内容区域，符合现代软件设计规范
- **可折叠区域**：群信息和成员列表区域可以折叠，但始终保持至少一个区域处于展开状态
- **主题切换**：支持多种主题颜色方案，适应不同使用场景和个人偏好
- **表格排序**：成员列表默认按角色排序，群主、管理员、普通成员依次排列
- **响应式布局**：界面元素会根据窗口大小自动调整
- **群列表筛选**：支持通过名称或群号搜索特定群聊
- **数据缓存**：群列表支持缓存，减少不必要的网络请求

## 数据导出功能

### 导出选项
- **导出格式**：支持CSV和JSON两种格式
- **成员范围**：可选择导出全部成员、仅管理员和群主、或仅活跃成员(30天内有发言)
- **自定义字段**：可选择需要导出的具体字段，如QQ号、昵称、群名片、角色等

### CSV格式
导出的CSV文件可包含以下可选字段：QQ号、昵称、群名片、加群时间、最后发言时间、角色、性别、年龄、地区、QQ等级、群等级等

### JSON格式
导出的JSON文件包含所选择的字段，格式化后易于阅读和二次处理

## 项目结构

- `vimeGroup.py`: 主程序，包含GUI界面和主要逻辑
- `group.py`: 辅助程序文件

## 系统要求

- Python 3.6+ 及以上
- PyQt5
- 网络连接（用于API请求）

## 版本历史

- v1.0 (2024-04-08): 初始版本
- v1.1 (2025-04-08): 优化界面布局，增加主题选择功能
- v1.2 (2025-04-08): 增加群成员禁言功能
- v1.3 (2025-04-09): 新增群列表功能，改进UI设计，增加自定义导出字段

## 注意事项

- 需要正确配置API服务器地址和认证Token
- 大型群（成员数超过1000）的数据加载可能需要较长时间
- 导出大量数据时可能会占用较多系统资源
- 禁言功能需要当前账号具有管理员或群主权限，否则将禁言失败
- 群列表数据会根据设置进行缓存，可在设置中调整缓存时间

## 许可证

MIT License